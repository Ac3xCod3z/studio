

const fs = require('fs');
const path = require('path');
const sharp = require('sharp');

const svgIcon = `
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="118" height="112">
<path d="M0 0 C0.98548828 -0.00773438 1.97097656 -0.01546875 2.98632812 -0.0234375 C19.03973238 0.01911626 30.77395087 5.75948629 42.26171875 16.76171875 C44.5625 19.25 44.5625 19.25 45.5625 22.25 C46.779375 21.92 47.99625 21.59 49.25 21.25 C52.43460604 20.44677787 55.2597843 20.04358027 58.5625 20.25 C58.03382185 25.2724424 56.34020794 29.26909992 54.20703125 33.78515625 C53.36969971 36.98731506 54.1767923 38.29904107 55.5625 41.25 C59.52685749 56.47211625 55.47967766 71.49687402 48.484375 85.0390625 C46.28907444 88.70682075 43.83735322 91.66059241 40.75 94.6015625 C39.32018826 96.17821109 39.32018826 96.17821109 39.8671875 98.16796875 C40.09664063 98.85503906 40.32609375 99.54210937 40.5625 100.25 C40.65167199 101.81050976 40.6926671 103.37445308 40.6875 104.9375 C40.69136719 106.11892578 40.69136719 106.11892578 40.6953125 107.32421875 C40.5625 109.25 40.5625 109.25 39.5625 110.25 C36.73663249 110.40322744 33.95206118 110.48162755 31.125 110.5 C30.33544922 110.520625 29.54589844 110.54125 28.73242188 110.5625 C26.44140625 110.578125 26.44140625 110.578125 22.5625 110.25 C21.9025 109.26 21.2425 108.27 20.5625 107.25 C20.00046875 107.4665625 19.4384375 107.683125 18.859375 107.90625 C6.87374674 111.87694893 -8.7262174 112.42761968 -20.4375 107.25 C-20.9325 108.735 -20.9325 108.735 -21.4375 110.25 C-27.3775 110.25 -33.3175 110.25 -39.4375 110.25 C-39.2725 107.960625 -39.1075 105.67125 -38.9375 103.3125 C-38.82125145 99.35665512 -38.891619 96.14622254 -41.0078125 92.671875 C-42.39553374 91.24721821 -43.81630831 89.85413403 -45.265625 88.4921875 C-53.93408952 79.54308924 -55.78559842 67.26125806 -55.6875 55.375 C-55.69523437 54.44558594 -55.70296875 53.51617187 -55.7109375 52.55859375 C-55.69774764 47.8300298 -55.36832888 43.56314587 -54.26953125 38.95703125 C-53.27756143 34.48830014 -53.75137717 31.96597531 -55.875 27.8125 C-58.52361691 22.50835073 -58.52361691 22.50835073 -57.4375 19.25 C-53.1475 20.24 -48.8575 21.23 -44.4375 22.25 C-43.7775 20.93 -43.1175 19.61 -42.4375 18.25 C-30.6036228 5.39815487 -17.29167107 -0.13517919 0 0 Z " fill="#D02F27" transform="translate(58.4375,-0.25)"/>
<path d="M0 0 C15.84 0 31.68 0 48 0 C48.020625 6.97125 48.04125 13.9425 48.0625 21.125 C48.071604 23.31527832 48.08070801 25.50555664 48.09008789 27.76220703 C48.09301028 29.51074157 48.09555807 31.25927678 48.09765625 33.0078125 C48.10277222 33.90556396 48.10788818 34.80331543 48.11315918 35.72827148 C48.11378477 40.24379277 48.08529433 44.58684549 47 49 C39.91316765 55.61437686 26.37300576 54.44773791 17.27734375 54.26171875 C11.41896466 54.00823738 5.27906499 53.27906499 1 49 C-0.3049966 43.72750485 -0.1283984 38.40245475 -0.09765625 33.0078125 C-0.09664917 32.16855225 -0.09564209 31.32929199 -0.09460449 30.46459961 C-0.08940127 27.35138569 -0.07544014 24.23819137 -0.0625 21.125 C-0.041875 14.15375 -0.02125 7.1825 0 0 Z " fill="#F8F4EF" transform="translate(35,56)"/>
<path d="M0 0 C0.99902344 -0.01224609 1.99804688 -0.02449219 3.02734375 -0.03710938 C17.33202435 -0.06515777 28.7223776 4.12947652 39.4375 13.75 C40.21347534 14.43823853 40.21347534 14.43823853 41.00512695 15.14038086 C44.10495765 18.06727088 45.11623684 20.03784989 45.75 24.1875 C32.14540164 26.85336163 18.95940255 27.66042582 5.10791016 27.57861328 C1.8853095 27.56255138 -1.33603109 27.57854724 -4.55859375 27.59765625 C-18.03669528 27.60922544 -30.97156801 26.4888153 -44.25 24.1875 C-43.22369131 18.2954154 -40.65855025 16.05570265 -36.25 12.1875 C-35.34894531 11.39279297 -35.34894531 11.39279297 -34.4296875 10.58203125 C-24.12034973 2.19221453 -12.89158036 0.00819033 0 0 Z " fill="#F7F2ED" transform="translate(58.25,-0.1875)"/>
<path d="M0 0 C2.75 -0.25 2.75 -0.25 6 0 C7.35432675 1.31200404 8.68733482 2.64631404 10 4 C13.14481791 4.80315654 13.14481791 4.80315654 16 5 C16 5.99 16 6.98 16 8 C16.66 8 17.32 8 18 8 C18 9.98 18 11.96 18 14 C15.36 14 12.72 14 10 14 C10 15.98 10 17.96 10 20 C12.64 20 15.28 20 18 20 C18.43813908 33.38758304 17.1303528 46.6732607 16 60 C9.96389687 58.7808469 7.37619586 53.85286204 4 49 C-1.63783437 39.57534957 -3.34963995 30.91479327 -3.3125 20.0625 C-3.33666992 18.65581055 -3.33666992 18.65581055 -3.36132812 17.22070312 C-3.36568571 10.95013633 -2.37145494 5.80616152 0 0 Z " fill="#F6E9E3" transform="translate(6,35)"/>
<path d="M0 0 C3 0.25 3 0.25 5 2.25 C10.12841725 18.77490003 6.68300365 35.11653849 -1.16015625 50.08984375 C-3.45309604 54.02824776 -5.70349257 57.10333382 -9 60.25 C-9.99 60.25 -10.98 60.25 -12 60.25 C-12.06058594 59.22519531 -12.12117188 58.20039062 -12.18359375 57.14453125 C-12.26805026 55.78384305 -12.35269567 54.42316657 -12.4375 53.0625 C-12.47681641 52.38896484 -12.51613281 51.71542969 -12.55664062 51.02148438 C-12.73194613 48.25705142 -12.92575106 45.58193643 -13.53125 42.875 C-14.26872987 38.74511273 -14.10307204 34.62266156 -14.0625 30.4375 C-14.05798828 29.55384766 -14.05347656 28.67019531 -14.04882812 27.75976562 C-14.03709866 25.58981441 -14.01916495 23.41989828 -14 21.25 C-11.36 21.25 -8.72 21.25 -6 21.25 C-6 18.94 -6 16.63 -6 14.25 C-9.3 14.25 -12.6 14.25 -16 14.25 C-16 12.27 -16 10.29 -16 8.25 C-15.01 8.25 -14.02 8.25 -13 8.25 C-13 7.26 -13 6.27 -13 5.25 C-12.16855469 4.95996094 -12.16855469 4.95996094 -11.3203125 4.6640625 C-10.59585938 4.40367188 -9.87140625 4.14328125 -9.125 3.875 C-8.40570313 3.61976562 -7.68640625 3.36453125 -6.9453125 3.1015625 C-3.89935459 1.76819137 -3.55126524 0.29593877 0 0 Z " fill="#F7F1EC" transform="translate(108,34.75)"/>
<path d="M0 0 C0.99 0.33 1.98 0.66 3 1 C3 1.66 3 2.32 3 3 C5.97 3.33 8.94 3.66 12 4 C12 4.33 12 4.66 12 5 C32.295 5.495 32.295 5.495 53 6 C53 6.33 53 6.66 53 7 C37.49 7 21.98 7 6 7 C5.67 23.17 5.34 39.34 5 56 C6.32 56.66 7.64 57.32 9 58 C9 59.65 9 61.3 9 63 C3.06 63 -2.88 63 -9 63 C-9.13392857 51.75 -9.13392857 51.75 -8 48 C-7.34 48 -6.68 48 -6 48 C-6.01160156 47.38213623 -6.02320313 46.76427246 -6.03515625 46.12768555 C-6.11827264 37.98599007 -5.59972369 29.92903081 -5 21.8125 C-4.90328878 20.46552038 -4.80693243 19.11851523 -4.7109375 17.77148438 C-4.47743008 14.51405585 -4.24037781 11.2569275 -4 8 C-6.64 8 -9.28 8 -12 8 C-12 6.35 -12 4.7 -12 3 C-11.38511719 2.95101562 -10.77023438 2.90203125 -10.13671875 2.8515625 C-9.32847656 2.77679688 -8.52023438 2.70203125 -7.6875 2.625 C-6.88699219 2.55539063 -6.08648437 2.48578125 -5.26171875 2.4140625 C-2.72775559 2.10435574 -2.72775559 2.10435574 0 0 Z " fill="#CE2A22" transform="translate(28,47)"/>
<path d="M0 0 C0.66 0.33 1.32 0.66 2 1 C3.64941386 6.66986013 3.71145934 12.92236612 4.25 18.78320312 C4.37375 20.08354492 4.37375 20.08354492 4.5 21.41015625 C4.5721875 22.19527588 4.644375 22.98039551 4.71875 23.78930664 C4.95532813 25.99732763 4.95532813 25.99732763 5.52514648 28.09838867 C6.20719611 30.8297432 6.09302202 33.4419741 6.0625 36.25 C6.05347656 37.32765625 6.04445313 38.4053125 6.03515625 39.515625 C6.02355469 40.33546875 6.01195313 41.1553125 6 42 C6.66 42 7.32 42 8 42 C9.75328507 45.02840149 10.25093193 47.19874367 10.1875 50.6875 C10.18105469 51.47511719 10.17460938 52.26273438 10.16796875 53.07421875 C10 55 10 55 9 56 C6.13732433 56.07325168 3.299281 56.09238205 0.4375 56.0625 C-0.36880859 56.05798828 -1.17511719 56.05347656 -2.00585938 56.04882812 C-4.00393756 56.03700518 -6.00197783 56.01906914 -8 56 C-8.33 54.35 -8.66 52.7 -9 51 C-8.01 51 -7.02 51 -6 51 C-5.19139222 48.15355592 -4.87199581 45.61758263 -4.8581543 42.66210938 C-4.85111984 41.81442993 -4.84408539 40.96675049 -4.83683777 40.09338379 C-4.83267349 39.18600464 -4.82850922 38.27862549 -4.82421875 37.34375 C-4.80103077 35.41535354 -4.77691386 33.48696807 -4.75195312 31.55859375 C-4.71677603 28.52352421 -4.68745091 25.48886237 -4.67407227 22.45361328 C-4.65862066 19.52066125 -4.61844355 16.58889066 -4.57421875 13.65625 C-4.57612717 12.74887085 -4.57803558 11.8414917 -4.58000183 10.90661621 C-4.45700862 4.58442739 -4.45700862 4.58442739 -1.96411133 1.39648438 C-1.31595459 0.93564453 -0.66779785 0.47480469 0 0 Z " fill="#D0281F" transform="translate(89,54)"/>
</svg>
`;

const SIZES = [
  { size: 512, name: 'icon-512x512.png', purpose: 'any' },
  { size: 192, name: 'icon-192x192.png', purpose: 'any' },
  { size: 180, name: 'apple-touch-icon.png', purpose: 'maskable' },
  { size: 32, name: 'favicon-32x32.png', purpose: 'any' },
  { size: 16, name: 'favicon-16x16.png', purpose: 'any' },
];

const publicDir = path.join(process.cwd(), 'public');

if (!fs.existsSync(publicDir)) {
  fs.mkdirSync(publicDir, { recursive: true });
}

async function generate() {
  const manifestIcons: { src: string, sizes: string, type: string, purpose?: string }[] = [];
  
  for (const { size, name, purpose } of SIZES) {
    const outputPath = path.join(publicDir, name);
    await sharp(Buffer.from(svgIcon))
      .resize(size, size)
      .toFile(outputPath);
      
    console.log(`Generated ${name}`);
    
    manifestIcons.push({
      src: `/${name}`,
      sizes: `${size}x${size}`,
      type: 'image/png',
      purpose: purpose,
    });
  }
  
  const manifest = {
    name: 'Centsei',
    short_name: 'Centsei',
    description: 'Your personal finance sensei',
    start_url: '/',
    display: 'standalone',
    background_color: '#f8f4ef',
    theme_color: '#d02f27',
    icons: manifestIcons,
  };

  fs.writeFileSync(path.join(publicDir, 'manifest.json'), JSON.stringify(manifest, null, 2));
  console.log('Generated manifest.json');
}

generate().catch(console.error);
